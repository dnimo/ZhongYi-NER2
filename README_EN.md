![loge](img/loge-1.png)
# A pointer network named entity labeling model for ancient Chinese medicine books based on Bert encoder
## Author information
Name: ZHANG GUOQING  
University: Shandong University of Traditional Chinese Medicine  
Organization: 2020 Microsoft Student Ambassador  
Major: Data Science and Big Data Technology  
Domains: Natural Language Processing, Digital Health Services  
Personal website: https://dnimo.github.io  
## Research motivation
Over the years, the Institute of Literature of our school has been concentrating on sorting out the texts of ancient Chinese medicine books, organizing batch after batch of ancient book data into electronic text data, forming a rich and diverse TCM corpus.
How to excavate the TCM knowledge hidden in this corpus and make it efficiently serve the subject of training high-quality TCM physicians has a very broad research prospect. In the project, the author uses natural language processing technology to enable computers to independently label and identify named entities in ancient Chinese medicine books to make up for the shortcomings of the open source community in this regard. From the database, we selected "Zhu Danxi - Medical Case Review", "Ye Tianshi - Medical Case Review", "Xue Lizhai - Medical Case Review", "Xie Yinglu - Medical Case Review", "The Essence of Modern Famous Chinese Medical Cases", 20 ancient Chinese medicine books, including "Review of 100 Doctors of Prescriptions in the Golden Chamber" and "Hundred Years of Chinese Medicine Clinicians in China" and other 20 ancient books of traditional Chinese medicine have been sorted out. A small-scale TCM text database.  
### Dataization of ancient Chinese books  
The data of ancient Chinese medicine books is the accumulation of medical events in the course of thousands of years of development, and is an important cornerstone for the inheritance, innovation and development of traditional Chinese medicine. After the 20th century, the rapid development of information technology and the digitization of ancient books of traditional Chinese medicine have also been put on the agenda. Shandong University of Traditional Chinese Medicine has a rich collection of ancient books. In the past ten years, the teachers of the Institute of Literature of our school have been devoted to ancient books. Digitization of documents. The introduction of digitization can improve the management level of ancient books. Not only China, but also major book collection institutions at home and abroad have built bibliographic databases. With the further standardization of the "metadata" of ancient books, the version form of ancient books has been described in more detail, and traditional bibliography has been gradually innovated with the advancement of digital technology.  
### Data Features  
#### Topicality
In the process of data sorting and labeling, we observed the first characteristic of the data of ancient Chinese medicine books: the content is generally topical.  
![figure 1](img/Picture1.png)  
The text recorded in the picture above describes the basic thinking model of traditional Chinese medicine, which is similar to the news style we are used to. News issues naturally form a topic, such as "the latest development of the new crown vaccine", and users will generate some related search behaviors around this topic, such as searching for "pneumonia", "lancet" and other potential topic intentions that need to be obtained. There are similar characteristics in ancient Chinese medicine books. In general, the author will have a long discussion around this certain disease, or collect relevant diagnosis and treatment plans for the treatment of such diseases, and attach their own comments.
![figure 2](img/Picture2.png)
What we want to talk about in this picture is a special topic in the data of ancient Chinese medicine books.Because there are many expressions about the physical symptoms of patients in ancient records, the terms in traditional Chinese medicine are also quite different from the pathology that we learn every day. The reason is that the translation is inaccurate. We do not correspond the terms in pathology to the terminology system of TCM well, so the sinicized terms of pathology introduced from the West have the same written expressions in the TCM system, but represent has a completely different meaning. For example, the "disease" in pathology is completely different from the "disease" and "symptom" in the Chinese medicine system. Diseases in Chinese medicine are not complicated. The standard of Chinese medicine to determine diseases is the most prominent symptoms or signs in the syndrome. The process from the beginning to the outcome of the symptoms or signs is called disease. Therefore, the diseases of traditional Chinese medicine are completely different from those of western medicine. Taking malaria as an example, under the thinking model of traditional Chinese medicine, as long as there is alternating cold and heat, it can be called malaria. When discussing diseases, Chinese medicine practitioners often throw out syndromes that they think are crucial, but which trouble them and are worth discussing. Miasma malaria (miasma malaria is divided into cold miasma, hot miasma), labor malaria, malaria mother. The above are called malaria, but the pathogenesis is quite different. Therefore, when a group of doctors initiates a discussion, certain words of "evidence" will naturally form a topic, which is to reveal the disease. Therefore, we believe that the content of ancient Chinese medicine books is generally topical.  
### Encoder based on BERT model
We use the MIT open-source sequence labeling model doccano for entity labeling. Due to manpower and time reasons, there are a total of 10,000 valid labeling samples. We use 7000 of them as training data to train the model, and the remaining 3000 datasets are used to evaluate the performance of the model. I am using a BERT model as an encoder for learning grammatical features from a corpus.
### Output Design of "Half Pointer-Half Annotation" Based on Pointer Network
If we use one of the simplest solutions that output a 0/1 sequence: directly label each word in the material with the answer of "yes (1)" or "no (0)". However, this effect is not good, because an answer may be composed of multiple different words in a row. It requires the model to label these different words with the same result, and the design requirements of the model are too high, so the author finally chose to use two different words. The method of secondary labeling, respectively labeling the start position and end position of the entity. At the same time, in order to deal with a word that may correspond to multiple different labels in different contexts, when predicting entity labels, we change the commonly used softmax function to a sigmoid function, which allows multiple entities to correspond to multiple relationships. . The final model output is two columns of floating-point numbers, which represent the score of the starting position and ending position of the entity, respectively.
## The overall structure
![figure 3](img/Picture3.png)
## About data acquisition
This data set is public. To obtain the data set used in this project, please scan the QR code of the WeChat public account, or visit the author's website to view the contact information.
## Disclaimer
The experimental results presented in the report only indicate the performance under a specific dataset and hyperparameter combination, and do not represent the essence of each model. The experimental results may be changed by random number seeds and computing equipment. The content in this project is for technical research reference only and does not serve as any conclusive basis. Users can use this model arbitrarily within the scope of the license, but we are not responsible for direct or indirect losses caused by the use of the content of this project.
# contact us
![wechat](img/wechat_channel.jpg)